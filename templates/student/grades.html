{% extends "dashboard/base.html" %}
{% load static %}

{% block content %}
<h2>My Grades</h2>

<form method="get" style="margin-bottom: 20px;">
    <label for="semester">Semester:</label>
    <select name="semester" id="semester" onchange="this.form.submit()">
        <option value="">All</option>
        {% for sem in request.user.studentprofile.available_semesters %}
            <option value="{{ sem }}"
                {% if sem|stringformat:"s" == request.GET.semester %}
                    selected
                {% endif %}
            >
                Semester {{ sem }}
            </option>
        {% endfor %}
    </select>
</form>

<table class="data-table">
    <thead>
        <tr>
            <th>Course Code</th>
            <th>Course Name</th>
            <th>Credits</th>
            <th>Grade</th>
            <th>Grade Point</th>
        </tr>
    </thead>

    <tbody>
        {% for g in grades %}
        <tr>
            <td>{{ g.course_offering.course.course_code }}</td>
            <td>{{ g.course_offering.course.course_name }}</td>
            <td>{{ g.course_offering.course.credits }}</td>
            <td><strong>{{ g.final_grade }}</strong></td>
            <td>{{ g.grade_point }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" style="text-align:center; color:#6b7280;">
                No grades available.
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if grades %}
<div style="margin-top: 20px;">
    <p><strong>SGPA:</strong> {{ sgpa|default:"-" }}</p>
    <p><strong>CGPA:</strong> {{ cgpa|default:"-" }}</p>
</div>
{% endif %}

<p style="margin-top: 15px; color: #6b7280;">
    Note: Only finalized and frozen grades are displayed.
</p>
{% endblock %}
